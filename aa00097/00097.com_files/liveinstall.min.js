(function(p){typeof define=="function"&&define.amd?define(p):p()})(function(){"use strict";var K=Object.defineProperty,Y=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var E=(p,f,u)=>f in p?K(p,f,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[f]=u,k=(p,f)=>{for(var u in f||(f={}))te.call(f,u)&&E(p,u,f[u]);if(q)for(var u of q(f))ne.call(f,u)&&E(p,u,f[u]);return p},M=(p,f)=>Y(p,ee(f));var N=(p,f,u)=>new Promise((_,C)=>{var R=g=>{try{b(u.next(g))}catch(U){C(U)}},S=g=>{try{b(u.throw(g))}catch(U){C(U)}},b=g=>g.done?_(g.value):Promise.resolve(g.value).then(R,S);b((u=u.apply(p,f)).next())});const p=t=>{if(typeof t!="object")return;let n=t instanceof Array?[]:{};for(let o in t)typeof t[o]=="object"?n[o]=p(t[o]):n[o]=t[o];return n},f=(t,n=!0,o)=>{t=t||{},t=n?p(t):t;for(const s in t)t.hasOwnProperty(s)&&(o?o(t,s,t[s])&&delete t[s]:t[s]===void 0&&delete t[s]);return t},u=t=>{for(var n=Object.keys(t).sort(),o={},s="",i=0;i<n.length;i++)o[n[i]]=t[n[i]],s+=o[n[i]];return s};function _(t){let n="";if(navigator.userAgent.split(")")[0].includes("HMSCore")){const o=navigator.userAgent.split(")")[0].split("HMSCore")[0].split(";");n=o[o.length-2]}else if(t.system=="iOS")if(t.device!="Tablet"){const o=[["430,1000,3","A18 Pro","iPhone 16 Pro Max"],["422,968,3","A18 Pro","iPhone 16 Pro"],["430,1000,3","A17","iPhone 16 Plus"],["390,844,3","A17","iPhone 16"],["430,932,3","A17 Pro","iPhone 15 Pro Max"],["400,875,3","A17 Pro","iPhone 15 Pro"],["430,1000,3","A16","iPhone 15 Plus"],["430,875,3","A16","iPhone 15"],["430,932,3","A15","iPhone 14 Pro Max"],["393,852,3","A15","iPhone 14 Pro"],["375,812,3","A15","iPhone 13(12) min"],["428,926,3","A14","iPhone 14(12/13) Plus"],["390,844,3","A14","iPhone 14(12/13)"],["414,896,3","A13","iPhone 11 Pro Max(Xs Max)"],["375,812,3","A13","iPhone 11 Pro(X/Xs)"],["414,896,2","A13","iPhone 11(XR)"],["414,736,3","A12","iPhone 8(7/6s) Plus"],["375,667,2","A11","iPhone 8(7/6)"],["320,568,2","A11","iPhone 5(s/se)"],["320,480,2","A10","iPhone 4(s)"]],s=window.screen.width,i=window.screen.height,h=parseInt(window.devicePixelRatio),A=s+","+i+","+h;o.some(I=>{I[0]===A&&(n=I[2])}),n||(n=t.system+" "+t.systemVersion)}else n="ipad";else t.system=="Android"&&(n=new UAParser().getResult().device.model,n||(n=t.system+" "+t.systemVersion));return n}const C=()=>{var t=navigator.userAgent,n=browser.parse(t),o="",s="",i=!1,h=!1,A=!1;return n.system=="iOS"?(o=n.system+" "+n.systemVersion,s=_(n),h=!0):n.system=="Android"?(o=n.system+" "+n.systemVersion,s=_(n),i=!0):(o=n.system+" "+n.systemVersion,s="pc",A=!0),{name:i?"android":h?"ios":"pc",type:s,version:o,isAndroid:i,isIOS:h,isPC:A}},R=(t,n,o)=>{const s=new ClipboardJS(t,k({text(i){let h=n;return typeof n=="function"&&(h=n(i)),h instanceof Element&&(h=h.textContent||""),h===void 0&&(h=i.textContent||""),h||console.error("content 内容不能为空！"),h}},o));s.on("success",function(i){console.info("Action:",i.action),console.info("Text:",i.text),console.info("Trigger:",i.trigger),i.clearSelection()}),s.on("error",function(i){console.error("Action:",i.action),console.error("Trigger:",i.trigger)})},S=t=>{const n=t||window.location.search;return new URLSearchParams(n)},b=t=>{const n=t+"=",o=document.cookie.split(";");for(let s=0;s<o.length;s++){const i=o[s].trim();if(i.indexOf(n)===0)return i.substring(n.length,i.length)}return""},U=Object.freeze(Object.defineProperty({__proto__:null,deepClone:p,getCookie:b,getDevice:C,getInviteCode:()=>{const t=S();return t.get("code")||t.get("inviteCode")||window.sessionStorage.getItem("inviteCode")||""},getModel:_,getQuery:S,paramSortStr:u,removeUndefinedProperties:f,toClipboard:R},Symbol.toStringTag,{value:"Module"}));(t=>{window[t]=window[t]||{configs:{}};const n=window[t];let o=!1,s=[],i=!1;n.utils=U;function h(e,r,c){try{const d=CryptoJS.enc.Utf8.parse(r),m=CryptoJS.enc.Utf8.parse(c);var l=CryptoJS.enc.Utf8.parse(e),a=CryptoJS.AES.encrypt(l,d,{iv:m,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return a.toString()}catch(d){console.log(d)}}n.on=function(e,r){s.push({name:e,fn:r}),i&&e==="loaded"&&r()},n.off=function(e,r){s=s.filter(c=>r?e!==c.name&&r!==c.fn:e!==c.name)};const A={download:"https://a5.a5cdn.com/api/live-install-service/live-install/downloadInit"},I={UPJ:"https://js.a5cdn.com/js/liveinstall/ua-parser-js@2.0.0/ua-parser.pack.min.js",BROT:"https://js.a5cdn.com/js/liveinstall/browser-tool@1.3.2/browser.min.js",LMD5:"https://js.a5cdn.com/js/liveinstall/blueimp-md5@2.19/md5.min.js",LClipboard:"https://js.a5cdn.com/js/liveinstall/clipboard@2.0.11/clipboard.min.js",LCrypto:"https://js.a5cdn.com/js/liveinstall/crypto-js@4.2.0/crypto-js.js"};Promise.all(Object.keys(I).map(e=>B(e,I[e]))).then(()=>{i=!0,s.filter(e=>e.name==="loaded").forEach(e=>e.fn())});function B(e,r){return new Promise((c,l)=>{const a=document.querySelector("#"+e),d=a||document.createElement("script");a?c(d):(d.id=e,d.src=r,document.head.appendChild(d),d.onload=function(){c(d)},d.onerror=function(m){l(m)})})}function F(e){const c=["screenHeight","screenWidth","devType","osVersion","inviteCode","comId","phoneName","timeZone","wi","n"].reduce((a,d)=>M(k({},a),{[d]:e[d]}),{}),l=u(c);return md5(md5(l)+"85484e99ffe38096b0091cceb7f5e795")}function H(e,r){typeof r=="object"||console.error("[liveInstall] args type Error! type is not valid.");let l=f(r||Object.create(null),!0,(P,y,v)=>v==null);const{name:a,type:d,version:m}=C();return k({screenHeight:window.screen.height>window.screen.width?window.screen.height:window.screen.width,screenWidth:window.screen.width<window.screen.height?window.screen.width:window.screen.height,devType:d,osVersion:m,phoneName:a,timeZone:`UTC${new Date().getTimezoneOffset()/60}`,n:"1",clickId:e.clickId},l)}function X(e,r){return N(this,null,function*(){var w,P,y,v,j,T,x,O,L,$,D,J;r.wi="";const c=F(r),l=H(e,r);l.sign=c;const a=S(),m=((y=(P=(w=e.sfbid)!=null?w:a.get("sfbid"))!=null?P:localStorage.getItem("sfbid"))!=null?y:"")?{fbid:(T=(j=(v=e.sfbid)!=null?v:a.get("sfbid"))!=null?j:localStorage.getItem("sfbid"))!=null?T:"",fbp:(L=(O=(x=e.fbp)!=null?x:a.get("fbp"))!=null?O:b("_fbp"))!=null?L:"",fbc:(J=(D=($=e.fbc)!=null?$:a.get("fbc"))!=null?D:b("_fbc"))!=null?J:""}:{};return Object.assign(l,{fbid:"",fbp:"",fbc:""},m),l})}function z(e){let r=A.download;if(e.urlType){const c=A[e.urlType];if(!c)return console.error(`[liveInstall]无法找到类型相关的地址！not found url by type of "${e.urlType}".`);r=c}return e.baseUrl&&(r=e.baseUrl),r}n.downloadApp=(e,r)=>N(this,null,function*(){e||(e={});const c=S();e.clickId||(e.clickId=c.get("click_id")||localStorage.getItem("kwai-click_id")||"");const l=G(e,r);if(o){console.info("loading...");return}r=r||{};const a=z(e),d=yield X(e,r),m=new URLSearchParams(d).toString();return o=!0,fetch(`${a}?${m}`,{method:"POST",redirect:"follow"}).then(w=>w.json()).then(w=>{const P=C();let y=w.obj.url;if(e!=null&&e.apkUrl&&P.isAndroid)switch(e.type){case"w2a":y=W(e);break;default:y=e.apkUrl;break}return e.handleJump?e.handleJump({targetUrl:y,deviceInfo:P,response:w,clipboardContent:l,configs:e,data:r}):window.location.href=y,w}).finally(()=>{o=!1})});function W(e){const r=new URL(window.location.href).searchParams,c=["fbpid","fb_pixel_id","fb_access_token"],l={redirect:e.apkUrl||"",fb_pixel_id:e.fb_pixel_id||"",fb_access_token:e.fb_access_token||"",campaign:`${r.get("p1")} (${r.get("p2")})`,adgroup:`${r.get("p3")} (${r.get("p4")})`,creative:`${r.get("p5")} (${r.get("p6")})`,fbpid:r.get("fbpid")||"",fbclid:r.get("fbclid")||""},a=Object.keys(l).filter(m=>c.includes(m)?l[m]:!0).reduce((m,w)=>M(k({},m),{[w]:l[w]}),{});return"https://app.adjust.com/"+`${r.get("p0")}?${new URLSearchParams(a).toString()}`}function Z(e,r){const c=r.comId,l=Q(e,r),a=h(JSON.stringify(l),"9216345272696329","0507060302080104");return`GP:${c}:${a||""}`||""}function G(e,r){var l;const c=Z(e,r);return(l=navigator.clipboard)==null||l.writeText(c),c}function Q(e,r){var y;const c=S(),l=e.clickId,a={a:(y=r.inviteCode)!=null?y:""},d=sessionStorage.getItem("clickid"),m=sessionStorage.getItem("source"),w=sessionStorage.getItem("adsname");d&&m&&w&&(a.h="http://www.pbterra.com/name/"+w+"/at?subid_short="+d+"&source="+m);const P=()=>{var j,T,x,O,L,$,D,J,V;a.b=e.domain||location.origin;const v=(x=(T=(j=e.sfbid)!=null?j:c.get("sfbid"))!=null?T:localStorage.getItem("sfbid"))!=null?x:"";v&&(a.c=v,a.d=($=(L=(O=e.fbc)!=null?O:c.get("fbc"))!=null?L:b("_fbc"))!=null?$:"",a.e=(V=(J=(D=e.fbp)!=null?D:c.get("fbp"))!=null?J:b("_fbp"))!=null?V:"")};switch(e.type){case"fb":return l?a.g=l:P(),a;case"kwai":return M(k({},a),{g:l});case"w2a":default:return a}}})("LI")});
